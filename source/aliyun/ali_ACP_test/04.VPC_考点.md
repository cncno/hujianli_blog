# VPC（专有网络）

### 考点整理

1.专有网络（Virtual Private Cloud，简称VPC）隔离了虚拟网络。每个VPC都有一个独立的隧道号，一个隧道号对应着一个虚拟化网络。

2.一个VPC内的ECS（Elastic Compute Service）实例之间的传输数据包都会加上隧道封装，带有唯一的隧道ID标识，然后送到物理网络上进行传输
不同VPC内的ESC的隧道ID不同，处于不同的两个路由平面，不同VPC内的ECS实例无法进行通信

3.VPC包含交换机、网关和控制器三个重要的组件

4.弹性公网IP（EIP）是可以独立购买和持有的公网IP地址资源

5.搭建专有网络的步骤：
步骤一 创建专有网络和交换机
步骤二 创建ECS实例
步骤三 创建EIP
步骤四 绑定EIP
步骤五 公网访问测试

6.可以在专有网络中使用阿里云资源如ECS、RDS、SLB等
同一个VPC内不同可用区的交换机默认内网互通

7.如果要使用标准网段的子网作为VPC的网段，需要使用API创建VPC

8.在删除交换机前，确保：您已经删除该交换机下创建的云资源如ECS、SLB、RDS等。

9.每个地域只有一个默认专有网络，但每个专有网络内的每个可用区都可创建一个默认交换机

10.创建专有网络后，系统会默认创建一个路由表控制专有网络的路由，所有专有网络内的交换机默认使用该路由表。您不能创建也不能删除默认路由表。

    每个专有网络最多可以有10张路由表，包括系统路由表。

11.创建专有网络后，系统会自动为您创建一张默认路由表并为其添加系统路由来管理专有网络的流量。
您不能创建系统路由，也不能删除系统路由，但您可以创建自定义路由替代系统路由，将指定目标网段的流量路由至指定的目的地。

12.创建专有网络后，系统会在路由表中自动添加如下系统路由：

	1.以100.64.0.0/10为目标网段的路由条目，用于VPC内的云产品通信。
	2.以交换机网段为目标网段的路由条目，用于交换机内的云产品通信

13.路由条目指定了网络流量的导向目的地，由目标网段、下一跳类型、下一跳三部分组成。路由条目包括系统路由和自定义路由。

14.路由表采用最长前缀匹配原则作为流量的路由选路规则。最长前缀匹配是指当路由表中有多条条目可以匹配目的IP时，采用掩码最长（最精确）的一条路由作为匹配项并确定下一跳。

15.创建VPC时,系统会自动为每个VPC创建1个路由器；
删除VPC时,会自动删除对应的路由器；
不支持直接创建和删除路由器；

16.每个VPC有且只有一个路由路由器
不支持BGP和OSPF等动态路由协议

17.VPC中ECS网络说明：

    1.可以使用经典网络公网IP作为负载均衡公网实例IP并加VPC ECS
	2.默认不能使用经典网络私网IP作为负载均衡私网实例IP并加VPC ECS；
	3.不能使用用户的VPC IP作为负载均衡私网实例并加非VPC ECS；
	4.一个实例不能同时存在VPC和非VPC的ECS；

18.ECS绑定EIP必须满足的要求：

		1.ECS实例的网络类型必须是专有网络。
		2.ECS实例的地域必须和EIP的地域相同。
		3.ECS实例必须处于运行中或停止状态。
		4.ECS实例没有配置固定公网IP或绑定其他EIP。
		5.一个ECS实例只能绑定一个EIP。

19.相同地域下不同可用区，SLB 、RDS 、OSS 同 ECS 之间都是可以直接内网互通连接使用的

20.专有网络类型的产品有：

	ECS；
	SLB；
	RDS；
	OSS；
	OCS；

21.阿里云专有网络 VPC 内部存在虚拟交换机和虚拟路由器，
可以像传统网络环境一样划分子网，每个子网内的云服务器 ECS 实例之间使用同一个虚拟交换机互联，
不同子网间的 ECS 实例之间使用虚拟路由器互联。

22.在DNAT方面，负载均衡是基于端口的负载均衡，即一个负载均衡的一个端口可以对应多台ECS。

23.连接2个VPC可以通过以下方式：

	1.VPN网关
	2.云企业网
	#VPC之间互通-----高速通道,2个VPC之间设置路由目标网段互指，设置静态路由条目，下一跳 VPC对端
    #VPC互通----VPN网关，路由目标网段互指，下一跳VPN网关

24.VPC + VPN/专线  实现了与传统数据中心组成一个定制的网络环境。

25.不同VPC之间内部网络完全隔离,只能通过对外映射的IP(弹性IP和NAT IP)互联.

26.传统数据中心中运行的应用平滑迁移到了阿里云上.现在需要从公网上接收用户请求,并使用阿里云的负载均衡SLB实例将这些请求分配到VPC中的多台云服务器ECS实例上去

    用户在VPC内创建负载均衡SLB实例,并挂载VPC内的ECS实例,通过跳板机接收外部请求,然后将这些请求通过负载均衡SLB实例分发给后端ECS实例
    用户创建公网IP的负载均衡SLB实例,挂载VPC中的ECS实例,这样来自于公网的请求就会被分流到VPC中的ECS实例上去处理

27.哪些云产品可以创建为专有网络类型?

	ECS
	RDS
	SLB
